---
layout: post
title: CMake + gtest + boost
date: 2016-12-11 19:18:37 +0800
categories: 随笔笔记
tags: googletest CMake boost
toc: true
comments: true
---
最近参与一个跨平台协作的项目，其中的CMake、googletest的引入以及支撑层基础模块的组织形式，是我之前的项目里没有接触过的。很快我需要组织一个类似的快平台项目，所以趁这次参与，把相关的工具摸索一遍。<!-- more -->

以前在Windows下写代码就是用Visual Studio生成solution，并在里面配置，同时把solution文件上传svn，在macOS下则使用xcode做同样的事情。但如果一个项目需要跨平台协作，需要在Windows、Linux、macOS下同时编译，这种方式就有很大的问题：项目需要引入哪些模块、模块之间的依赖关系，要在各平台下的IDE工具里各自完成，但他们之间无法相互同步，这就引入了很多重复工作，并且不同平台下可能是不同的RD在负责，很容易带来不一致。

这个时候就需要CMake出场了，它用来描述一个工程的组织形式，需要编译什么可执行文件、静态/动态库文件，各模块的编译选项、链接选项等等。CMake可以用这一套描述在各平台下生成指定IDE工具的工程文件，它支持的IDE包括Visual Studio、XCode、Makefiles、Eclipse等。

其实以前仅在Windows下使用Visual Studio的时候，也会遇到一个项目需要编译成多种形式的情况，比如最常见的32位、64位各自的项目配置需要同步，更复杂一些的对于同一份代码要编译出不同的形式，比如要把正式版的exe中部分模块以DEBUG Lib库的形式编译给另一个exe以完成单元测试。以前我就是用VS生成多套项目配置，当项目大到有百十个模块，一旦某些模块之间的依赖关系或者编译、链接选项有变化时，就十分痛苦，同样的设置要做N遍。

这都是CMake可以解决的问题。引入CMake以后，各IDE的工程文件就成了CMake的输出结果，因此只需要把CMakelists.txt上传svn，sln、xcodeproj之类的工具相关的工程配置文件都不用再上传，每次生成就好了。